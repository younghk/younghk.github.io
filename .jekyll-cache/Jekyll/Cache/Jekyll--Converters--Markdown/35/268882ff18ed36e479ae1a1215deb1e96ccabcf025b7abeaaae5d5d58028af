I"¹Z<h2 id="message-authentication">Message Authentication</h2>

<ul>
  <li>Message authentication is concerned with:
    <ul>
      <li>Protecting the integrity of a message</li>
      <li>Validating identity of originator</li>
      <li>Non-repudiation of origin (dispute resolution)</li>
    </ul>
  </li>
  <li>
    <p>Three algternative functions for authenticator</p>

    <ul>
      <li>Hash function</li>
      <li>Message encryption</li>
      <li>Message authentication code(MAC)</li>
    </ul>
  </li>
  <li>
    <p>Requirements</p>

    <table>
      <thead>
        <tr>
          <th style="text-align: center">Attacks</th>
          <th style="text-align: center">Measures</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="text-align: center">Disclosure<br />Traffic analysis</td>
          <td style="text-align: center">Message hiding (e.g., encryption)</td>
        </tr>
        <tr>
          <td style="text-align: center">Masquerade<br />Content modification<br />Sequence modification<br />Timing modification</td>
          <td style="text-align: center">Message authentication<br />Digital signature</td>
        </tr>
        <tr>
          <td style="text-align: center">Source repudiation</td>
          <td style="text-align: center">Digital signature</td>
        </tr>
        <tr>
          <td style="text-align: center">Destination repudiation</td>
          <td style="text-align: center">Digital signature + additional protocol</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h3 id="symmetric-encryption-for-message-authentication">Symmetric Encryption for Message Authentication</h3>

<p>Encryption can provide authentication</p>

<ul>
  <li>ciphertext serves as its authenticator</li>
</ul>

<p>If symmetric encryption is used then:</p>

<ul>
  <li>Receiver know
    <ol>
      <li>Sender must have created it since only sender and receiver know key</li>
      <li>Content have not been altered
        <ul>
          <li>There must be some internal structure to plaintext so that the receiver can distinguish between well-formed plaintext and random bits</li>
        </ul>
      </li>
    </ol>
  </li>
</ul>

<h3 id="public-encryption-for-message-authentication">Public Encryption for Message Authentication</h3>

<p>Encryption provides no confidence of sender</p>

<ul>
  <li>Since anyone potentially knows public-key</li>
</ul>

<p>If sender signs message using his private-key</p>

<ul>
  <li>Have both secrecy and authentication</li>
</ul>

<p>Confidentiality, authentication, and signature at cost of two public-key uses on message</p>

<p>ì¦‰, specific ìœ ì €ë§Œ generate ê°€ëŠ¥í•˜ë©° ëª¨ë‘ê°€ ì‹ë³„ ê°€ëŠ¥í•œ ìƒí™©ì´ë‹¤.</p>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image1.png" alt="encryption for message authentication" /></p>

<p>(b) ì—ì„œëŠ” confidentiality ê°€ ì´ë£¨ì–´ì§€ê³  ìˆë‹¤.</p>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image2.png" alt="encryption for message authentication" /></p>

<p>(c) ì—ì„œ authentication ê³¼ signature ê°€ ê°€ëŠ¥í•¨ì„ í™•ì¸í•˜ì.<br />
ê·¸ë¦¬ê³  ì „í˜•ì ìœ¼ë¡œ ìœ„ì— ì–¸ê¸‰ëœ ê²ƒë“¤ì„ ì„ì–´ì„œ ì‚¬ìš©í•˜ëŠ” (d) ê°€ ìˆë‹¤.</p>

<h2 id="message-authentication-code">Message Authentication Code</h2>

<p><em>MAC(Message Authentication Code)</em> ì€ small fixed-size block ì„ ë§Œë“¤ì–´ë‚´ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ í†µí•´ ìƒì„±ëœë‹¤.<br />
ì´ ë•Œ, message ì™€ key ì— ì˜í•´ ê°’ì´ ë‚˜ì˜¤ê²Œ ë˜ëŠ”ë°, encryption ê³¼ ë¹„ìŠ·í•˜ë‹¤ê³  ë³¼ ìˆ˜ ìˆìœ¼ë‚˜ reverse ë¥¼ ì—¼ë‘í•  í•„ìš”ê°€ ì—†ëŠ” ê³¼ì •ì´ë¼ëŠ” ê²ƒì´ ì°¨ì´ì ì´ë‹¤.</p>

<p>ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ <em>MAC</em> ì€ message ì— ë¶™ì–´ <strong>signature</strong> ë¡œ ì´ìš©ë˜ê²Œ ëœë‹¤.</p>

<p>ìˆ˜ì‹ ìëŠ” ë©”ì„¸ì§€ì— ëŒ€í•´ ê°™ì€ ê³¼ì •ì„ ìˆ˜í–‰í•´ì„œ <em>MAC</em> ê³¼ ë¹„êµí•´ë³´ê³  ì´ê²ƒì´ ì „ì†¡ê³¼ì • ì¤‘ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ì•„ë‹Œì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>

<p>MAC = C(K, M) ìœ¼ë¡œ í‘œí˜„ ê°€ëŠ¥í•œë°, Hash Function ì—ì„œëŠ” single parameter ë¥¼ ê°€ì¡Œë˜ ê²ƒê³¼ ë¹„êµí•´ë³´ê¸¸ ë°”ë€ë‹¤.</p>

<p>ìˆ˜ì‹ ìê°€ ë°›ì€ <em>MAC</em> ê³¼ ê³„ì‚°í•œ <em>MAC</em> ì„ ë¹„êµí•´ ë³¼ ê²½ìš°</p>

<ol>
  <li>ìˆ˜ì‹ ìëŠ” í•´ë‹¹ ë©”ì„¸ì§€ê°€ ë³€í•˜ì§€ ì•Šì•˜ë‹¤ëŠ” ê²ƒì„ ë¯¿ì„ ìˆ˜ ìˆë‹¤.</li>
  <li>ìˆ˜ì‹ ìëŠ” í•´ë‹¹ ë©”ì„¸ì§€ê°€ ì˜ì‹¬ë˜ëŠ” ì†¡ì‹ ì(sender)ë¡œë¶€í„° ì „ì†¡ë˜ì—ˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.</li>
  <li>ìˆ˜ì‹ ìëŠ” ë©”ì„¸ì§€ê°€ ìˆœì„œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë²ˆí˜¸ë¥¼ ê°€ì§€ê³  ìˆë‹¤ë©´ ì í•©í•œ ìˆœì„œë¥¼ ì•Œ ìˆ˜ ìˆê²Œ ëœë‹¤.</li>
</ol>

<p><em>MAC</em> ì˜ ê¸°ë³¸ì ì¸ ì„¸ ê°€ì§€ ì“°ì„ìƒˆë¥¼ ê°„ëµí•˜ê²Œ ì‚´í´ë³´ì.</p>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image3.png" alt="basic uses of mac" /></p>

<p><strong>a.</strong> ê¸°ë³¸ì ì¸ message authentication ì— ì‚¬ìš©ëœ ëª¨ìŠµì´ë‹¤.<br />
<strong>b.</strong> authentication ì— confidentiality ë¥¼ ì¶”ê°€í•˜ê¸° ìœ„í•´ ì•”í˜¸í™” ê³¼ì •ì„ í•œ ë²ˆ ê±°ì¹˜ê²Œ ëœë‹¤. (MAC before the encryption, MAC from the plaintext) ìˆ˜ì‹ ì ì…ì¥ì—ì„œëŠ” ë³µí˜¸í™”ë¥¼ ë¨¼ì € í•œ í›„ integrity ë¥¼ check í•˜ê²Œ ëœë‹¤.<br />
<strong>c.</strong> ë§ˆì°¬ê°€ì§€ë¡œ confidentiality ë¥¼ ì¶”ê°€í•˜ë‚˜, ë©”ì„¸ì§€ì— ëŒ€í•œ ì•”í˜¸í™”ë¥¼ ë¨¼ì € í•˜ê³  MAC ì´ ciphertext ë¡œë¶€í„° ì˜¨ë‹¤ëŠ” ê²ƒì´ ì°¨ì´ê°€ ìˆë‹¤.(MAC after encryption, MAC from the ciphertext) ì´ë ‡ê²Œ í•  ê²½ìš° integrity ë¥¼ ë¨¼ì € í™•ì¸í•˜ê³  ê·¸ í›„ ë³µí˜¸í™”ë¥¼ ì§„í–‰í•˜ë©´ ë˜ëŠ”ë° ì´ëŠ” ì•½ê°„ ë” íš¨ìœ¨ì ì´ê²Œ ëœë‹¤.</p>

<p>ë³´í†µ MAC before encryption ì„ ì„ í˜¸í•˜ëŠ”ë° MAC after encryption ë§Œì´ CCA-secure ë¥¼ ë§Œì¡±í•œë‹¤.</p>

<ul>
  <li>When instantiated using an arbitrary CPA-secure encryption and an arbitrary secure MAC (with unique tags)</li>
</ul>

<p>ì´ëŠ” application ë³„ë¡œ ë‹¤ë¥¸ ì‹œë‚˜ë¦¬ì˜¤ê°€ ì¡´ì¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ìƒí™©ì— ë§ì¶°ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>

<p>ì´ëŸ¬í•œ <em>MAC</em> ì„ ì•”í˜¸í™” ëŒ€ì‹  ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œ?</p>

<ul>
  <li>ë•Œë¡œëŠ” authentication ë§Œ ìˆì–´ë„ ë˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤.</li>
  <li>ë•Œë¡œëŠ” authentication ì„ ì•”í˜¸í™”ë³´ë‹¤ ë” ì˜¤ë˜ ê°€ì§€ê³  ê°€ì•¼í•  ê²½ìš°ê°€ ìˆë‹¤. (e.g., archival use)</li>
  <li>í™•ì¥ì„±, â€¦</li>
</ul>

<p>ê·¸ëŸ¬ë‚˜ <em>MAC</em> ì€ <em>Digital Signature</em> ê°€ ì•„ë‹Œ ê²ƒì— ì£¼ì˜í•´ì•¼í•˜ëŠ”ë°, <em>MAC</em> ì—ì„œëŠ” secret key ê°€ shared ë˜ê¸° ë•Œë¬¸ì— digital signature ê°€ ë  ìˆ˜ ì—†ë‹¤.(key ê°€ ì—¬ëŸ¬ êµ°ë° ì¡´ì¬í•˜ë©´ ëˆ„ê°€ ë³´ë‚´ëŠ”ì§€ íŠ¹ì •í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸)</p>

<h3 id="mac-properties">MAC Properties</h3>

<ul>
  <li><em>MAC</em> ì€ cryptographic checksum ì´ë¼ ë³¼ ìˆ˜ ìˆë‹¤.</li>
</ul>

\[\text{MAC} = C_K(M)\]

<p>ê°€ë³€ ê¸¸ì´ì¸ message M ì´ secret key K ë¥¼ í†µí•´ fixed-size authenticator ê°€ ë˜ëŠ” ê²ƒì„ ìƒê°í•˜ì.</p>

<ul>
  <li>Many-to-One function
    <ul>
      <li>potentially many messages have same MAC = collision</li>
      <li>ê·¸ëŸ¬ë‚˜ collision ì„ ì°¾ê¸°ë€ ì‰½ì§€ ì•Šë‹¤.</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>MAC ê³¼ Hash ì¤‘ ì–´ë–¤ ê²ƒì´ collision ì— ë” ì–´ë ¤ìš¸ê¹Œ?
ë‘˜ ë‹¤ collision ì„ ë§Œë“¤ì–´ë‚´ëŠ” ë°©ë²•ì´ ë„ì¶œë˜ì§€ëŠ” ì•Šì•˜ìœ¼ë‚˜ MAC ì´ ë” ì–´ë µë‹¤ê³  ìƒê°ëœë‹¤.
MAC ì€ ë‘ ê°œì˜ parameter ë¥¼ ê°€ì§€ê³  ìˆê¸°ë„ í•˜ê³ , MAC ì— birthday attack ì„ ì‹¤í–‰í•˜ë ¤ë©´ ëª¨ë“  MAC ì½”ë“œê°€ ë™ì¼í•œ key ë¡œ ë§Œë“¤ì–´ì ¸ìˆì–´ì•¼ í•œë‹¤.
ì´ëŠ” ì‚¬ì‹¤ìƒ ë¶ˆê°€ëŠ¥í•˜ë¯€ë¡œ ì¢‹ì§€ ì•Šì€ ê³µê²©ë°©ë²•ì´ ëœë‹¤.</p>
</blockquote>

<h3 id="requirements-for-macs">Requirements for MACs</h3>

<p><em>MAC</em> ì€ ë‹¤ìŒê³¼ ê°™ì€ requirements ë¥¼ ê°€ì§„ë‹¤.</p>

<ul>
  <li>ê³µê²© ìœ í˜•ì— ëŒ€í•œ ê³ ë ¤ê°€ í•„ìš”í•˜ë‹¤.</li>
  <li>ë‹¤ìŒì˜ ì„¸ ê°€ì§€ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ í•œë‹¤.
    <ol>
      <li>message ì™€ MAC ì„ ì•Œê³  ìˆì„ ë•Œ ê°™ì€ MAC ì„ ê°€ì§„ ë‹¤ë¥¸ ë©”ì„¸ì§€ë¥¼ ì°¾ëŠ” ê²ƒì´ ì–´ë ¤ì›Œì•¼ í•œë‹¤.(message replacement attack, collision)</li>
      <li>MAC ì€ uniformly distributed ì—¬ì•¼ í•œë‹¤.(brute-force attack)</li>
      <li>MAC ì€ ëª¨ë“  ë¹„íŠ¸ì— ëŒ€í•´ ë™ë“±í•˜ê²Œ ë‚˜íƒ€ë‚˜ì•¼ í•œë‹¤(bias)</li>
    </ol>
  </li>
</ul>

<h3 id="security-of-macs">Security of MACs</h3>

<p>Brute-force attack</p>

<ul>
  <li>hash function ì—ì„œ ê·¸ ì•ˆì •ì„±ì€ hash code ì˜ ê¸¸ì´ì— ì˜ì¡´ì ì´ì—ˆë‹¤.
    <ul>
      <li>ê·¸ ì½”ìŠ¤íŠ¸ëŠ” O($2^{m \over 2}$)</li>
      <li>128-bit ëŠ” ìœ„í—˜í•˜ë©° 160-bit ì •ë„ëŠ” ë˜ì–´ì•¼ í•¨.</li>
    </ul>
  </li>
  <li>
    <p><em>MAC</em> ì—ì„œëŠ” known message-MAC pair ê°€ í•„ìš”í•˜ë‹¤.</p>

    <ul>
      <li>keyspace ë˜ëŠ” MAC ì„ ê³µê²©í•  ìˆ˜ ìˆë‹¤.</li>
      <li>ì¦‰, ë‘˜ ì¤‘ ì‘ì€ cost ì˜ ê³µê²©ì„ ì„ íƒí•˜ë©´ ëœë‹¤.($\min(2^k, 2^m)$)</li>
      <li>ì´ë¡œ ì¸í•´ 128-bit MAC ì´ ìµœì†Œ í•„ìš”í•˜ë‹¤.</li>
    </ul>
  </li>
</ul>

<p>Cryptanalytic attack</p>

<ul>
  <li>block cipher ì²˜ëŸ¼ brute-force attack ì˜ ëŒ€ì²´ ìˆ˜ë‹¨ìœ¼ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤.</li>
  <li>MAC ì˜ êµ¬ì¡°ìƒ ê·¸ ë³€í˜•ì´ í›¨ì”¬ ë§ì´ ë•Œë¬¸ì— generalize í•˜ì—¬ cryptanalysis ë¥¼ ìˆ˜í–‰í•˜ëŠ”ê²Œ ì¡°ê¸ˆ ë³µì¡í•˜ê¸°ë„ í•˜ë‹¤.</li>
</ul>

<h3 id="mac-based-on-hash-function">MAC Based on Hash Function</h3>

<p>hash function ì„ ê¸°ë°˜ìœ¼ë¡œ <em>MAC</em> ì„ ë§Œë“œëŠ” ê²½ìš°ë¥¼ ìƒê°í•´ë³´ì.<br />
ì´ ë•Œ, hash function ì„ ì´ìš©í•˜ëŠ” ì´ìœ ë¡œ hash ë¥¼ ì´ìš©í•˜ë©´ ë¹ ë¥¼ ë¿ ì•„ë‹ˆë¼ crypto hash function code ê°€ ê´‘ë²”ìœ„í•˜ê²Œ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì´ë‹¤.(available)</p>

<p>ë˜í•œ hash ëŠ” ë©”ì„¸ì§€ì— ì†í•œ í‚¤ë¥¼ í¬í•¨í•˜ê³  ìˆê¸°ë„ í•˜ë‹¤.<br />
ì›ë˜ì˜ ëª©ì ì€ KeyedHash = Hash(Key|Message) ì¸ë°, ì´ë¥¼ í™œìš©í•˜ë©´ ëª‡ê°€ì§€ ì·¨ì•½ì ì„ í™•ì¸í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>

<p>ì´ë¡œ ì¸í•´ ì•„ì˜ˆ ìƒˆë¡­ê²Œ HMAC ì´ë¼ëŠ” ê²ƒì„ ê°œë°œí•´ë‚´ê²Œ ë˜ì—ˆë‹¤.</p>

<h2 id="hmac">HMAC</h2>

<p><em>HMAC</em> ì€ ë‹¤ìŒì˜ ì„¤ê³„ ëª©í‘œë¥¼ ê°€ì§€ê³  ìˆë‹¤.</p>

<ul>
  <li>available hash function ì„ ìˆ˜ì •ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.</li>
  <li>embedded hash function ì— ëŒ€í•´ ì‰¬ìš´ êµì²´ ê°€ëŠ¥ì„±ì„ í—ˆë½í•œë‹¤.</li>
  <li>ëˆˆì— ë„ëŠ” ì•½í™” ê³¼ì • ì—†ì´ ì›ë˜ì˜ hash function ì˜ ì„±ëŠ¥ì´ ë‚˜ì˜¬ ìˆ˜ ìˆë„ë¡ í•œë‹¤.</li>
  <li>í‚¤ë¥¼ ë‹¤ë£¨ê³  ì‚¬ìš©í•˜ëŠ”ê²Œ ê°„ë‹¨í•´ì•¼ í•œë‹¤.</li>
  <li>ì¸ì¦ ë§¤ì»¤ë‹ˆì¦˜ì˜ strength ì— ëŒ€í•œ cryptographic analysis ë¥¼ ì˜ ì´í•´í•œ ìƒíƒœì—¬ì•¼ í•œë‹¤.</li>
</ul>

<p>ì´ëŸ¬í•œ <em>HMAC</em> ì€ message ì— ëŒ€í•´ hash function ì„ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.</p>

\[\text{HMAC}_K(M) = \text{Hash}\left[\left(K^+ \text{ XOR } \text{opad}\right)\ ||\ \text{Hash}\left[\left(K^+ \text{ XOR } \text{ipad}\right)\ ||\ M\right]\right]\]

<ul>
  <li>ì—¬ê¸°ì„œ $K^+$ ëŠ” key ê°€ ì™¼ìª½ì— b-bit ë§Œí¼ì˜ zero-pad ë¥¼ ê°€ì§„ ê²ƒì´ë‹¤.</li>
  <li>opad, ipad ëŠ” ê°ê° 00110110, 01011100 ì„ b/8 ë§Œí¼ ë°˜ë³µí•œ íŠ¹ìˆ˜í•œ padding constant ì´ë‹¤.</li>
</ul>

<p>ì´ëŸ¬í•œ <em>HMAC</em> ì€ ì„¤ê³„ ëª©í‘œë¡œ ì¸í•´ ì•„ë¬´ í•´ì‰¬ í•¨ìˆ˜(MD4, SHA-1, RIPEMD-160, Whirlpool, â€¦)ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image4.png" alt="hmac overview" /></p>

<h3 id="hmac-security">HMAC Security</h3>

<p><em>HMAC</em> ì€ ê·¸ êµ¬ì¡°ìƒ hash algorithm ì˜ ë³´ì•ˆì„±ê³¼ ì—°ê´€ì´ ìˆë‹¤.</p>

<p>ê·¸ë ‡ê¸° ë•Œë¬¸ì— <em>HMAC</em> ì„ ê³µê²©í•˜ëŠ” ê²ƒì€ hash í•¨ìˆ˜ë¥¼ ê³µê²©í•˜ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•˜ê²Œ ëœë‹¤.</p>

<ul>
  <li>brute-force attack on key : O($2^n$)</li>
  <li>birthday attack : O($2^{n \over 2}$)
    <ul>
      <li>ê·¸ëŸ°ë° keyed ë˜ì—ˆê¸° ë•Œë¬¸ì— ë§¤ìš° ë§ì€ ì–‘ì˜ ë©”ì„¸ì§€ë¥¼ ê´€ì°°í•´ì•¼ë§Œ í•˜ê²Œ ë˜ì—ˆë‹¤.</li>
      <li>ê³µê²©ìëŠ” ê°™ì€ í‚¤ì— ëŒ€í•´ $2^n$ ë§Œí¼ì˜ ë©”ì„¸ì§€ ë¸”ë¡ì„ í™•ì¸í•´ì•¼ í•œë‹¤.</li>
      <li>ë”°ë¼ì„œ 128-bit MD5 ê°™ì€ ê²ƒë„ <em>HMAC</em> ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p>hash function ì€ ì•„ì£¼ ë¹ ë¥¸ ê²ƒë“¤ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ë³´ì•ˆì ì¸ ì¸¡ë©´ê³¼ ì†ë„ì ì¸ ì¸¡ë©´ì„ ê³ ë ¤í•´ ê³ ë¥¼ ìˆ˜ ìˆë‹¤.</p>

<h2 id="mac-based-on-block-ciphers">MAC based on Block Ciphers</h2>

<p>hash function ë§ê³ ë„ block cipher ì¤‘ chaining mode ì¸ ê²ƒì— ëŒ€í•´ ë§ˆì§€ë§‰ ë¸”ë¡ì„ MAC ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ìˆë‹¤.</p>

<ol>
  <li>Data authentication algorithm(DAA)
    <ul>
      <li>ì´ì œëŠ” ì“°ì§€ ì•ŠëŠ”ë‹¤.</li>
    </ul>
  </li>
  <li>Cipher-based message authentication code(CMAC)
    <ul>
      <li>DAA ì˜ ë¬¸ì œì ì„ ë³´ì™„í•´ëƒˆë‹¤.</li>
    </ul>
  </li>
</ol>

<h3 id="daa">DAA</h3>

<p><em>DAA</em> ëŠ” DES-CBC ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ MAC ì´ë‹¤.</p>

<ul>
  <li>IV = 0, zero-pad ë¥¼ ë§ˆì§€ë§‰ ë¸”ë¡ì— ì£¼ê²Œ ëœë‹¤.</li>
  <li>ë©”ì„¸ì§€ ì•”í˜¸í™”ë¥¼ DES-CBC ë¡œ ì²˜ë¦¬í•œë‹¤.</li>
  <li>ë§ˆì§€ë§‰ ë¸”ë¡ë§Œ MAC ìœ¼ë¡œ ì „ì†¡í•˜ê²Œ ëœë‹¤.<small>ë˜ëŠ” 16~64 bits ì˜ leftmost bits ë§Œ ì „ì†¡</small></li>
</ul>

<p>ê·¸ëŸ¬ë‚˜ ì´ëŠ” MAC ì˜ í¬ê¸°ê°€ ë„ˆë¬´ ì‘ì•„ì„œ ë¬¸ì œê°€ ëœë‹¤.</p>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image5.png" alt="daa" /></p>

<p>ìœ„ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤ì‹œí”¼ <em>DAA</em> ëŠ” sequential í•˜ê²Œ ì§„í–‰ë˜ëŠ” CBC operation ì´ë‹¤. ì´ëŠ” ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰ë˜ê¸° ë•Œë¬¸ì— performance(speed) ê°€ ë‚®ê²Œ ë‚˜ì˜¬ ìˆ˜ ìˆê²Œ ëœë‹¤.</p>

<p>ë˜í•œ ê³µê²©ì ì…ì¥ì—ì„œ collision ì„ ì°¾ìœ¼ë ¤ê³  í• í…ë°, ì´ ë•Œ original message ë¥¼ ì‰½ê²Œ ë°”ê¿€ ìˆ˜ ìˆê²Œ ëœë‹¤ë©´ ë¬¸ì œê°€ ë  ê²ƒì´ë‹¤.</p>

<p>DES ëŠ” ì•ì„œ ì‚´í´ë³´ì•˜ë“¯ì´ ì´ë¯¸ ê¹¨ì§„ ì•”í˜¸í™” ê¸°ë²•ì´ë¯€ë¡œ ì´ë¥¼ ë” ê°•í•œ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ëŒ€ì²´í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.<br />
ê·¸ëŸ¬ë‚˜ ì´ë¥¼ ëŒ€ì²´í•œë‹¤ í•˜ë”ë¼ë„ sequential í•œ ì§„í–‰ìœ¼ë¡œ ì¸í•œ speed ì˜ ë¬¸ì œëŠ” ì—¬ì „íˆ ì¡´ì¬í•œë‹¤.</p>

<p>ì´ëŸ¬í•œ <em>DAA</em> ëŠ” ê½¤ ê´‘ë²”ìœ„í•˜ê²Œ ì‚¬ìš©ë˜ì—ˆëŠ”ë° ê²°êµ­ êµ¬ì¡°ì  ì·¨ì•½ì ìœ¼ë¡œ ì¸í•´ ì‚¬ìš©í•˜ì§€ ì•Šê²Œ ë˜ì—ˆë‹¤.</p>

<p><em>n</em> ì˜ cipher block size ì™€ <em>m</em> ì˜ fixed positive integer ê°€ ìˆë‹¤ë©´ <em>DAA</em> ì˜ ê²°ê³¼ê°’ì€ mn bits ê°€ ë˜ëŠ”ë°, ì´ëŸ¬í•œ ë©”ì„¸ì§€ ê¸¸ì´ì˜ í•œê³„ê°€ ìˆê¸°ë„ í•˜ì˜€ë‹¤.</p>

<p>ë˜í•œ ê³µê²©ìê°€ ì‰½ê²Œ ê°™ì€ <em>MAC</em> ì„ ë§Œë“¤ì–´ë‚´ëŠ” ë‹¤ë¥¸ block ì„ ì°¾ì„ ìˆ˜ ìˆì—ˆë˜ ê²ƒë„ ë¬¸ì œì´ë‹¤.</p>

<p>X ê°€ one-block message ë¼ê³  í•  ë•Œ,</p>

\[T = \text{MAC}(K, X) \\
X||(X \oplus T)\]

<p>ìœ„ì™€ ê°™ì´ X ì™€ ê°™ì€ <em>MAC</em> ì„ ê°–ëŠ” ë‹¤ë¥¸ block ì„ ì°¾ì„ ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.</p>

<h3 id="cmac">CMAC</h3>

<p>ì´ëŸ¬í•œ <em>DAA</em> ì˜ ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œ 3 keys ë¥¼ ì‚¬ìš©í•´ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ê·¸ë ‡ê²Œ íƒ„ìƒí•œ ê²ƒì´ <em>Cipher-based Message Authentication Code(CMAC)</em> ì´ë‹¤.</p>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image6.png" alt="cmac overview" /></p>

<p><em>CMAC</em> ì—ì„œëŠ” ìœ„ì˜ ê·¸ë¦¼ì—ì„œ ë³´ë‹¤ì‹œí”¼ multiple key($K, K_1, K_2$) ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì´ ë•Œ ìµœì¢…ì ìœ¼ë¡œ ë‚˜ì˜¨ ì•”í˜¸ê°’ì˜ MSB(Most Significant Bit) ë¡œ T ë§Œí¼ë§Œ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.<br />
ì´ëŸ¬í•œ êµ¬ì¡°ë¡œ <em>DAA</em> ì˜ ë‹¨ì ì„ ê·¹ë³µí•˜ê³  <em>HMAC</em> ê³¼ í•¨ê»˜ ë§ì´ ì“°ì´ëŠ” ë°©ì‹ì´ë‹¤.</p>

<h2 id="authenticated-encryption">Authenticated Encryption</h2>

<p><em>Authenticated Encryption</em> ì€ confidentiality ì™€ authenticity ë¥¼ ë™ì‹œì— ë§Œì¡±í•˜ë„ë¡ í•˜ëŠ” Concept ì´ë‹¤.</p>

<p>ì´ëŠ” ì¢…ì¢… í•„ìš”í•œ ê²½ìš°ê°€ ìˆìœ¼ë‚˜ ë³´í†µì€ ë”°ë¡œ ë¶„ë¦¬ë˜ì–´ ìˆë‹¤.</p>

<ol>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Hash-then-encrypt: E(K, (M</td>
          <td>Â </td>
          <td>H(M)))</td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>WEP protocol (wifi security, WEP2, WPA)</li>
    </ul>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>MAC-then-encrypt: E(K2, (M</td>
          <td>Â </td>
          <td>MAC(K1, M)))</td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>SSL/TLS protocols (http)</li>
    </ul>
  </li>
  <li>Encrypt-then-MAC: C=E(K2, M), T=MAC(K1, C)
    <ul>
      <li>IPsec protocol (VPN, MAC with associated ciphertext)</li>
    </ul>
  </li>
  <li>Encrypt-and-MAC: C=E(K2, M), T=MAC(K1, M)
    <ul>
      <li>SSH protocol (efficiency, parallelly computed M)</li>
    </ul>
  </li>
</ol>

<p>ì´ë ‡ê²Œ ë‘ ë³´ì•ˆì„±ì„ ì¶©ì¡±ì‹œí‚¤ëŠ” ë°©ë²•ìœ¼ë¡œ ë‘ ê°€ì§€ ëª¨ë“œê°€ ìˆë‹¤.</p>

<ul>
  <li>Counter with Cipher Block Chaining Message Authentication Code(CCM)</li>
  <li>Galois/Counter Mode(GCM)</li>
</ul>

<h3 id="ccm">CCM</h3>

<p><em>CCM</em> ì€ WiFi ë¥¼ ìœ„í•œ NIST í‘œì¤€ì´ë‹¤. (SP 800-38C)</p>

<p>ì•ì„œ ì‚´í´ë³¸ 4 ê°€ì§€ ê²½ìš° ì¤‘ <strong>encrypt-and-MAC</strong> ì˜ í•œ ë³€í˜•ì´ë‹¤.<br />
ì‚¬ìš©í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ë“¤ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ul>
  <li>AES encryption</li>
  <li>CTR mode of operation</li>
  <li>CMAC authentication algorithm</li>
</ul>

<p>encryption ê³¼ MAC ì„ ìœ„í•´ single key ê°€ ì‚¬ìš©ëœë‹¤.</p>

<p>ì´ ë•Œ input elements ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ul>
  <li>Plaintext message P of data block
    <ul>
      <li>authenticated and encrypted</li>
    </ul>
  </li>
  <li>Associated data A
    <ul>
      <li>Authenticated but not encrypted</li>
    </ul>
  </li>
  <li>Nonce N(random variable)
    <ul>
      <li>Unique and different for every instance</li>
      <li>Prevent replay attack</li>
    </ul>
  </li>
</ul>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image7.png" alt="ccm operation" /></p>

<p><em>CCM</em> ì€ ìœ„ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì§„í–‰ì´ ëœë‹¤.</p>

<p>authentication ì„ ìœ„í•´ <em>Tag</em> ë¥¼ ë§Œë“¤ì–´ ë‚´ëŠ”ë°, ì´ ë•Œ <em>CMAC</em> ì„ ì‚¬ìš©í•œë‹¤.<br />
ì—¬ê¸°ì„œ <em>CMAC</em> ì˜ êµ¬ì¡°ìƒ parallel í•˜ê²Œ ì²˜ë¦¬ë˜ì§€ ì•ŠìŒì„ ìƒê¸°í•˜ì.</p>

<p><em>CTR</em> ì€ <em>AES</em> ê°€ counter operation ìœ¼ë¡œ ì§„í–‰ë˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ê³ , $Ctr_0$ ëŠ” intial counter ì´ë‹¤.</p>

<p>ì´ëŸ°ì‹ìœ¼ë¡œ ciphertext ë¥¼ ë§Œë“¤ì–´ë‚´ê²Œ ëœë‹¤.</p>

<h3 id="gcm">GCM</h3>

<p><em>GCM</em> ì—­ì‹œ NIST í‘œì¤€(SP 800-38D)ì´ë‹¤.</p>

<p>Parallelizible for high throughput, ì¦‰, parallel í•œ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•œ ê²ƒì´ íŠ¹ì§•ì´ë‹¤.</p>

<p>ì—­ì‹œ ë©”ì„¸ì§€ëŠ” <em>CTR</em> ì˜ ë°©ì‹ìœ¼ë¡œ ì•”í˜¸í™”ë˜ë©° ìœ í•œì²´(finite(Galois) field) ë‚´ì—ì„œ ciphertext ê°€ key ì™€ message ê¸¸ì´ë¡œ ê³±í•´ì ¸ì„œ authenticator tag ë¥¼ ìƒì„±í•˜ê²Œ ëœë‹¤.</p>

<p>MAC-only mode ì™€ GMAC ì„ ì§€ì›í•œë‹¤.</p>

<p>ë‹¤ìŒê³¼ ê°™ì€ ë‘ ê°€ì§€ function ì„ ì‚¬ìš©í•œë‹¤.</p>

<ol>
  <li>GHASH - a keyed hash function</li>
  <li>GCTR - CTR mode with incremented counter</li>
</ol>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image8.png" alt="gcm authentication and encryption functions" /></p>

<p>ì–¼í• ë³´ê¸°ì— sequential í•˜ê²Œ ì§„í–‰ë  ê²ƒ ê°™ìœ¼ë‚˜ ê° block ì„ ë”°ë¡œ ê³„ì‚°í•œ í›„ XOR í•´ì£¼ë©´ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤.</p>

<p>ì´ê²ƒì´ CCM mode ì˜ <em>CMAC</em> ê³¼ í° ì°¨ì´ì ì´ë‹¤.</p>

<ul>
  <li>proof
    <ul>
      <li>multiplication distributes over addition in a field</li>
      <li>For field, the XOR operation is the addition operation</li>
      <li>Consider a message consisting of two blocks</li>
      <li>The GHASH function is $((X_1 \cdot H) \oplus X_2) \cdot H$</li>
      <li>Multiplying through by H, we get $(X_1 \cdot H^2) \oplus (X_2 \cdot H)$</li>
      <li>repeatedly applying other blocks</li>
    </ul>
  </li>
</ul>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image9.png" alt="gcm authentication and encryption functions" /></p>

<p><em>GCTR</em> í•¨ìˆ˜ì˜ ë‚´ë¶€ ë™ì‘ ëª¨ìŠµì´ë‹¤.</p>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image10.png" alt="gcm mode overview" /></p>

<p><em>GCM</em> ì„ ì „ì²´ì ìœ¼ë¡œ ì‚´í´ë³´ë©´ ìœ„ì™€ ê°™ë‹¤.</p>

<h2 id="prng-using-hash-functions-and-macs">PRNG Using Hash Functions and MACs</h2>

<p><em>PRNG</em> ì˜ í•„ìˆ˜ì ì¸ ìš”ì†Œë“¤ì€ seed value ì™€ deterministic algorithm ì´ë‹¤.</p>

<p>ì´ ë•Œ, seed ëŠ” í•„ìš”í•œ ìœ ì €ì—ê²Œë§Œ ì•Œë ¤ì ¸ì•¼ í•œë‹¤.</p>

<p>ì´ëŸ¬í•œ PRNG ëŠ” ì•ì„  <a href="https://cheong.netlify.com/posts/other-public-key-cryptosystems/#pseudorandom-number-generation">í¬ìŠ¤íŠ¸</a>ì—ì„œì²˜ëŸ¼ ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•´ ë§Œë“¤ê±°ë‚˜ Hash function ë˜ëŠ” MAC ì„ ì´ìš©í•´ ë³¼ ìˆ˜ë„ ìˆë‹¤.</p>

<h3 id="prng-using-a-hash-function">PRNG using a Hash Function</h3>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image11.png" alt="prng using a hash function" /></p>

<p>SP800-90 ê³¼ ISO18031 ì— ë‚˜ì˜¨ hash-based PRNG ì´ë‹¤.</p>

<p>ë‹¤ìŒì˜ ê³¼ì •ìœ¼ë¡œ ì§„í–‰í•˜ê²Œ ëœë‹¤.</p>

<ul>
  <li>take seed V</li>
  <li>repeatedly add 1</li>
  <li>hash V</li>
  <li>use n-bit of hash as random value</li>
</ul>

<p>ê°•í•œ cryptographic hash (e.g., SHA-2) ë¥¼ ì‚¬ìš©í•˜ë©´ secure í•˜ë‹¤.<br />
<small>ë§Œì•½ MD-5, SHA-1 ê°™ì€ ê²ƒì„ ì“¸ ê²½ìš° collision attack ì— ì·¨ì•½</small></p>

<h3 id="prng-using-a-mac">PRNG using a MAC</h3>

<p><img src="/assets/images/2019-12-03---message-authentication-code/image12.png" alt="prng using a mac" /></p>

<p>MAC-based PRNG ëŠ” SP800-90, IEEE 802.11i, TLS/WTLS ì´ë‹¤. ì—¬ê¸°ì„œ 802 ëŠ” wifi standard ì´ê³  11i ëŠ” security standard ë¥¼ ì˜ë¯¸í•œë‹¤.</p>

<p>ì´ ë°©ì‹ì€ key ë¥¼ ì‚¬ìš©í•˜ê³  input ì€ last hash ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤.</p>

<p>ì´ëŸ¬í•œ ë°©ì‹ì€ network communication ì—ì„œ ê´‘ë²”ìœ„í•˜ê²Œ ì‚¬ìš©ë˜ê³  ìˆë‹¤.</p>

<h2 id="multi-user-security-of-gcm-in-tls">Multi-user Security of GCM in TLS</h2>

<p>MU security ëŠ” ë„¤íŠ¸ì›Œí¬ ìƒì—ì„œ í†µì‹ ì´ ë‹¤ì¤‘ ìœ ì € ê°„ì— ì´ë£¨ì–´ì§ˆ ë•Œ ë°˜ë“œì‹œ í•„ìš”í•œ ê²ƒì´ë‹¤. ì´ ë•Œ ì—¬ëŸ¬ ìœ ì € ì¤‘ í•œ ìœ ì €ê°€ ê³µê²©ë‹¹í•´ ëš«ë ¸ì„ ë•Œ ë‹¤ë¥¸ ìœ ì €ë“¤(sessions)ê¹Œì§€ ìœ„í—˜ì— ì²˜í•œë‹¤ë©´ ì •ë§ í°ì¼ì´ ë  ìˆ˜ ìˆë‹¤.</p>

<p>ì´ëŸ¬í•œ ìœ„í˜‘ì€ TLS 1.3 ì— ëª…ì‹œì ìœ¼ë¡œ ê³ ë ¤ë˜ê¸° ì‹œì‘í•˜ì˜€ë‹¤.<br />
TLS 1.2 ê¹Œì§€ëŠ” ìœ„í—˜í•œ ìœ„í˜‘ì´ì—ˆëŠ”ë° single key ê°€ ë‹¤ë¥¸ ìœ ì €ë“¤ì—ê²Œë„ ì‚¬ìš©ë˜ì—ˆê¸° ë•Œë¬¸ì´ë‹¤.</p>

<p>Crypto 2016 ì—ì„œ â€˜The Multi-user Security of Authenticated Encryption: AES-GCM in TLS 1.3â€™ ì´ë¼ëŠ” ê²ƒì´ ë°œí‘œë˜ì—ˆê³ , ìì„¸í•œ ê²ƒì€ ì´ ë¬¸ê±´ì„ í™•ì¸í•´ë³´ì.</p>

<h3 id="lucky-thirteen-attack">Lucky Thirteen Attack</h3>

<p><em>Lucky Thirteen Attack</em> ì€ <em>MAC</em> ì˜ timing side channel attack ì´ë‹¤.</p>

<p>padding oracle attack ì˜ ë³€í˜•ì„ í†µí•´ ê³µê²©ì„ ê°í–‰í•˜ë©°, TLS ì™€ DTLS(based on UDP) record protocol ì„ ëš«ëŠ”ë‹¤.</p>

<p>ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì„ ìƒê°í•´ë³´ì.</p>

<blockquote>
  <p>HMAC ì´ ìˆë‹¤.<br />
ì´ëŠ” êµ¬ì¡°ì ìœ¼ë¡œ hash ë¥¼ ì‚¬ìš©í•˜ê³ , hash ëŠ” iteration ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.<br />
ì´ ë•Œ ê°ê°ì˜ message block $M_k$ ëŠ” HMAC ìœ¼ë¡œ MAC ì„ ë§Œë“¤ê²Œ ë˜ëŠ”ë°, ì´ hash ì˜ iteration ì— ë”°ë¼ output ì´ ë‚˜ì˜¤ê¸° ê¹Œì§€ ì‹œê°„ì˜ ì°¨ì´ê°€ ìƒê¸¸ ê²ƒì´ë‹¤.<br />
ì´ê²ƒì„ ì´ìš©í•œ ê²ƒì´ ë°”ë¡œ timing attack ì´ ëœë‹¤.</p>

  <blockquote>
    <p>ê·¸ë ‡ë‹¤ë©´ ëª¨ë‘ constant time ì´ ê±¸ë¦¬ë„ë¡ ë§Œë“ ë‹¤ë©´ ì–´ë–¨ê¹Œ? ì˜ˆë¥¼ ë“¤ì–´ 10times ë§Œí¼ í˜¸ì¶œí•˜ê²Œ í•˜ëŠ” ê²ƒì´ë‹¤.<br />
ê·¸ëŸ¬ë‚˜ ì´ ì—­ì‹œ ì™„ë²½í•œ í•´ë²•ì´ ì•„ë‹Œë°, message M ê·¸ ìì²´ë¡œ êµ¬ì¡°ìƒ ë¯¸ë¬˜í•˜ê²Œë‚˜ë§ˆ time difference ê°€ ìƒê¸°ê²Œ ëœë‹¤.<br />
ì´ëŠ” condense function ì˜ êµ¬ì¡°ì  ë¬¸ì œì ìœ¼ë¡œ, M ì— ë”°ë¼ iteration ì´ ë°”ë€Œê¸° ë•Œë¬¸ì´ë‹¤.</p>
  </blockquote>
</blockquote>

<p><small>ìµœì¢… ìˆ˜ì •ì¼ : 2019-12-5</small></p>

<blockquote>
  <p>ë³¸ í¬ìŠ¤íŠ¸ëŠ” í•™ë¶€-_ì •ë³´ë³´í˜¸_ ë¥¼ ê³µë¶€í•˜ë©° ì •ë¦¬í•œ ê¸€ ì…ë‹ˆë‹¤.<br />
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆë‹¤ë©´ ì•Œë ¤ì£¼ì„¸ìš”!<br />
ê°ì‚¬í•©ë‹ˆë‹¤ :)</p>
</blockquote>
:ET