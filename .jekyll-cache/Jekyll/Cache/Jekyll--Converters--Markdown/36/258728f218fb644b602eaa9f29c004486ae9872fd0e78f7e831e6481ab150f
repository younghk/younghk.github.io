I"¼O<p>ë¬¸ì œ ì¶œì²˜ : https://www.acmicpc.net/problem/12886</p>

<h2 id="í’€ì´">í’€ì´</h2>

<p>ì´ ë¬¸ì œë¥¼ BFS ë¥¼ ì´ìš©í•´ ì™„ì „ íƒìƒ‰ì˜ ê¸°ë²•ìœ¼ë¡œ í’€ì–´ë‚¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì´ ë•Œ, $500^3$ ì„ ë°°ì—´ë¡œ ì¡ì„ ìˆ˜ê°€ ì—†ì–´ì„œ í—¤ë§¬ ìˆ˜ ìˆìœ¼ë‚˜,</p>

\[A+B+C = sum \\
C = sum-A-B\]

<p>ì´ë¼ëŠ” ê°„ë‹¨í•œ ìˆ˜í•™ì„ ì´ìš©í•˜ë©´ $500^2$ ì˜ ê³µê°„ì„ ê°€ì§€ê³  íƒìƒ‰ì„ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.</p>

<p>ë¬¼ë¡  500 ë§Œí¼ë§Œ ì¡ìœ¼ë©´ íƒìƒ‰ì„ í•˜ëŠ”ë° ì¡°ê¸ˆ ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆëŠ”ë°, 500ë³´ë‹¤ í° ë²”ìœ„ë¡œ ë°°ì—´ì„ ì„¤ì •í•´ì£¼ì–´ì•¼ í•œë‹¤.</p>

<p>X+X ì™€ Y-X ë¡œ ê°ê° ë³€í™”í•˜ëŠ” ìˆ«ìì— ìˆì–´ì„œ ìµœëŒ€ ìµœì†ŒëŠ” ê°ê° 0~1000 ì„ì„ ìƒê°í•  ìˆ˜ ìˆë‹¤.</p>

<p>ë”°ë¼ì„œ ê³µê°„ ë³µì¡ë„ëŠ” $1000^2$ ì´ ëœë‹¤.</p>

<p>ì´ê²ƒì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì€ ë‹¤ì–‘í•  ìˆ˜ ìˆëŠ”ë°, ì•„ë˜ëŠ” ì•„ì£¼ ëŒ€ì¶© ì§  ì½”ë“œì´ë‹¤.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;queue&gt;
#include &lt;algorithm&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">pii</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">MAX</span> <span class="o">=</span> <span class="mi">1010</span><span class="p">;</span>

<span class="kt">bool</span> <span class="n">check</span><span class="p">[</span><span class="n">MAX</span><span class="p">][</span><span class="n">MAX</span><span class="p">];</span>
<span class="n">queue</span><span class="o">&lt;</span><span class="n">pii</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">A</span> <span class="o">&gt;&gt;</span> <span class="n">B</span> <span class="o">&gt;&gt;</span> <span class="n">C</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">sum</span><span class="o">=</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">sum</span><span class="o">%</span><span class="mi">3</span><span class="p">){</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">A</span><span class="o">==</span><span class="n">B</span> <span class="o">&amp;&amp;</span> <span class="n">B</span><span class="o">==</span><span class="n">C</span><span class="p">){</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">M</span> <span class="o">=</span> <span class="n">sum</span><span class="o">/</span><span class="mi">3</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">A</span><span class="o">&gt;</span><span class="n">C</span><span class="p">){</span>
        <span class="n">swap</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">C</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">A</span><span class="o">&gt;</span><span class="n">B</span><span class="p">){</span>
        <span class="n">swap</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// A &lt; B &lt; C;</span>
    <span class="n">check</span><span class="p">[</span><span class="n">A</span><span class="p">][</span><span class="n">B</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">pii</span> <span class="n">k</span><span class="p">;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">);</span>
    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
    <span class="n">check</span><span class="p">[</span><span class="n">A</span><span class="p">][</span><span class="n">C</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">C</span><span class="p">);</span>
    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
    <span class="n">check</span><span class="p">[</span><span class="n">B</span><span class="p">][</span><span class="n">C</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">);</span>
    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
        <span class="n">k</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="n">A</span><span class="o">=</span><span class="n">k</span><span class="p">.</span><span class="n">first</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="n">k</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">sum</span><span class="o">-</span><span class="n">A</span><span class="o">-</span><span class="n">B</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">na</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">nb</span><span class="o">=</span><span class="n">B</span><span class="o">-</span><span class="n">A</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">na</span><span class="o">&gt;</span><span class="mi">1000</span> <span class="o">||</span> <span class="n">nb</span><span class="o">&gt;</span><span class="mi">1000</span> <span class="o">||</span> <span class="n">C</span><span class="o">&gt;</span><span class="mi">1000</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">na</span><span class="o">&lt;=</span><span class="mi">0</span> <span class="o">||</span> <span class="n">nb</span><span class="o">&lt;=</span><span class="mi">0</span> <span class="o">||</span> <span class="n">C</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="c1">//cout &lt;&lt; A &lt;&lt; " " &lt;&lt; B &lt;&lt; " " &lt;&lt; C &lt;&lt; endl;</span>
        <span class="n">pii</span> <span class="n">nk</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">na</span><span class="o">&gt;</span><span class="n">nb</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">[</span><span class="n">nb</span><span class="p">][</span><span class="n">na</span><span class="p">]){</span>
                <span class="n">check</span><span class="p">[</span><span class="n">nb</span><span class="p">][</span><span class="n">na</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">nk</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="n">nb</span><span class="p">,</span><span class="n">na</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">[</span><span class="n">na</span><span class="p">][</span><span class="n">nb</span><span class="p">]){</span>
                <span class="n">check</span><span class="p">[</span><span class="n">na</span><span class="p">][</span><span class="n">nb</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">nk</span> <span class="o">=</span> <span class="n">make_pair</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">nk</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">na</span><span class="o">&lt;</span><span class="n">C</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">[</span><span class="n">na</span><span class="p">][</span><span class="n">C</span><span class="p">]){</span>
                <span class="n">check</span><span class="p">[</span><span class="n">na</span><span class="p">][</span><span class="n">C</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">nk</span><span class="o">=</span><span class="n">make_pair</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">C</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">[</span><span class="n">C</span><span class="p">][</span><span class="n">na</span><span class="p">]){</span>
                <span class="n">check</span><span class="p">[</span><span class="n">C</span><span class="p">][</span><span class="n">na</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">nk</span><span class="o">=</span><span class="n">make_pair</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">na</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">nk</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">nb</span><span class="o">&lt;</span><span class="n">C</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">[</span><span class="n">nb</span><span class="p">][</span><span class="n">C</span><span class="p">]){</span>
                <span class="n">check</span><span class="p">[</span><span class="n">nb</span><span class="p">][</span><span class="n">C</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">nk</span><span class="o">=</span><span class="n">make_pair</span><span class="p">(</span><span class="n">nb</span><span class="p">,</span><span class="n">C</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">check</span><span class="p">[</span><span class="n">C</span><span class="p">][</span><span class="n">nb</span><span class="p">]){</span>
                <span class="n">check</span><span class="p">[</span><span class="n">C</span><span class="p">][</span><span class="n">nb</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">nk</span><span class="o">=</span><span class="n">make_pair</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">nb</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">nk</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">check</span><span class="p">[</span><span class="n">M</span><span class="p">][</span><span class="n">M</span><span class="p">];</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="ìˆ˜í•™ì -ì ‘ê·¼">ìˆ˜í•™ì  ì ‘ê·¼</h2>

<p>ê·¸ëŸ¬ë‚˜ ì´ ë¬¸ì œëŠ” ì´ëŸ¬í•œ ì™„ì „íƒìƒ‰ ê¸°ë²•ì„ ì ìš©í•˜ëŠ” ë¬¸ì œëŠ” ì•„ë‹ˆë‹¤.</p>

<p>ì„¸ ê°€ì§€ ìˆ˜ê°€ ëª¨ë‘ ê°™ì€ ìˆ˜ê°€ ë˜ë ¤ë©´ ì–´ë–¤ ìƒíƒœì¸ ê²ƒì¸ê°€?</p>

<p>ë°”ë¡œ <strong>í‰ê· </strong> ì´ë‹¤.</p>

<p>ì¦‰, ì„¸ ìˆ˜ì˜ í•©ì´ 3ì˜ ë°°ìˆ˜ê°€ ì•„ë‹ˆë©´ ë‹µì€ ìëª…í•˜ê²Œë„ 0 ì´ ë‚˜ì™€ì•¼ í•œë‹¤.</p>

<p>ê·¸ë ‡ë‹¤ë©´ ì„¸ ìˆ˜ì˜ í•©ì´ 3ì˜ ë°°ìˆ˜ì´ë©´ ë‹µì€ 1 ì¸ê°€?</p>

<p><em>ê·¸ë ‡ì§€ëŠ” ì•Šë‹¤.</em></p>

<p>í•´ë‹¹ ë¬¸ì œë¥¼ ë³´ë©´ ì‘ì€ ìˆ˜ X ëŠ” X+X ê°€ ë˜ì–´ 2X ê°€ ë˜ê²Œ ë˜ê³ , í° ìˆ˜ Y ëŠ” Y-X ê°€ ëœë‹¤.</p>

<p>ì—¬ê¸°ì„œ ì°©ì•ˆí•´ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì ‘ê·¼ì„ í•  ìˆ˜ ìˆë‹¤.</p>

<ol>
  <li>ì…ë ¥ê°’ì˜ í•©ì€ 3ì˜ ë°°ìˆ˜ì—¬ì•¼í•œë‹¤.</li>
  <li>ì…ë ¥ê°’ë“¤ì˜ ìµœëŒ€ê³µì•½ìˆ˜ë¡œ í•©ì„ ë‚˜ëˆ´ì„ ë•Œë„ 3ì˜ ë°°ìˆ˜ì—¬ì•¼ í•œë‹¤.(1ì˜ ê³„ì‚°ì€ ì—¬ê¸°ì„œ í•©ì³ì§„ë‹¤.)</li>
  <li>2ì—ì„œ ê³„ì‚°ëœ ê°’ì€ $2^k \times 3$ ê¼´ì´ì–´ì•¼ í•œë‹¤.</li>
</ol>

<p>ì–´ë–»ê²Œ ì´ëŸ° ì ‘ê·¼ ë°©ë²•ì´ ë‚˜ì™”ì„ê¹Œ?</p>

<p>í•µì‹¬ì€ X+X=2X, Y-X ê°€ ë˜ë©´ì„œ ë‹¤ìŒìœ¼ë¡œ ì§„í–‰ëœë‹¤ëŠ” ê²ƒì´ë‹¤.</p>

<p>ì¦‰, í•œ step ë§ˆë‹¤ ìˆ˜ì‹(ë˜ëŠ” ì¸ìˆ˜ë¼ê³ ë„ ìƒê°í•  ìˆ˜ ìˆë‹¤)ì— ì†Œì¸ìˆ˜ 2ê°€ ì¶”ê°€ë˜ëŠ” ê²ƒì´ê³ , ê²°êµ­ ìµœì¢…ì ìœ¼ë¡œ ì„¸ ìˆ˜ê°€ ê°™ì•„ì§€ëŠ” í‰ê·  Mì—ëŠ” ëª‡ ê°œì˜ ì†Œì¸ìˆ˜ 2ê°€ ìˆì„ ê²ƒì´ë‹¤. ì¦‰ $2^k$ í˜•íƒœê°€ ë˜ê²Œ ëœë‹¤.<br />
ì¡°ê¸ˆ ì—„ë°€í•˜ê²Œ ë§í•˜ìë©´, $M = 2^k * G$ ì˜ ê¼´ì´ ë  ê²ƒì¸ë°, ì—¬ê¸°ì„œì˜ $G$ ê°€ ë°”ë¡œ ìµœëŒ€ê³µì•½ìˆ˜(gcd) ì´ë‹¤.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;iostream&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">gcd</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
    <span class="n">x</span><span class="o">%=</span><span class="n">y</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">gcd</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">cal_bit</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">ret</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">32</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">ret</span><span class="o">+=</span><span class="n">k</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span>
        <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">A</span> <span class="o">&gt;&gt;</span> <span class="n">B</span> <span class="o">&gt;&gt;</span> <span class="n">C</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">q</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">gcd</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">)));</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">q</span><span class="o">%</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">cal_bit</span><span class="p">(</span><span class="n">q</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="ê°œì„ í• -ì ">ê°œì„ í•  ì </h2>

<ol>
  <li>naive BFS ì½”ë“œì—ì„œ ëª¨ë“ˆí™”í•˜ë©´ ì½”ë“œê°€ ê°„ê²°í•´ì§„ë‹¤. ë¦¬íŒ©í† ë§ì„ í•´ë³´ì.</li>
  <li>ìˆ˜í•™ì  ì ‘ê·¼ ë°©ë²•ì—ì„œ ì—„ë°€í•œ ì¦ëª…ì´ í•„ìš”í•˜ë‹¤.</li>
  <li>gcd ì™€ cal_bit ë¥¼ ë‚´ì¥ í•¨ìˆ˜(**gcd, **builtin_popcount)ë¥¼ ì‚¬ìš©í•  ê²½ìš° ì½”ë“œê°€ ê°„ê²°í•´ì§„ë‹¤.</li>
</ol>
:ET